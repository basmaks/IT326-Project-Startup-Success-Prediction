---
title: "Data Summarization and Preprocessing"
output: html_notebook
---
##### Phase 2 of Data Mining (IT 326) Project 

In recent years, Saudi Arabia has emerged as an increasingly attractive hub for entrepreneurs looking to establish their startups. Riyadh, the capital of Saudi Arabia, presents a wealth of opportunities for both founders and investors to bring forth innovative solutions.

### Project Motivation 

Our **motivation** in building this model is for it to act as a guiding beacon for investors. When the model predicts the success of a startup, it becomes an attractive investment opportunity, ensuring that investors see a return on their investment. Conversely, if a startup is showing signs of potential failure and closure, it prompts investors to explore alternative investments.


### Goal

In this project, our **goal** is to build a predictive model capable of predicting the potential success of startups. We aspire to utilize the insights gained from this model to test and predict the possible success of startups within the region.

#### Source
Access the dataset on Kaggle through the following link: https://www.kaggle.com/datasets/manishkc06/startup-success-prediction


## 1-General Information About the Dataset

**Number of attributes:** 50 column\
**Number of objects:** 925 row\
**Class label:** status ("acquired" --> successful company, or "closed" --> unsuccessful company)\
**Types of attributes:** Nominal, Numerical, Binary\
\
**Attribute Description**

| Attribute Name           | Description                                                  | Data Type | Possible Values                                 |
| ------------------------ | ------------------------------------------------------------ | --------- | ----------------------------------------------- |
| Unnamed: 0               | Method of numbering companies.                               | Nominal   | 1 to 1153                                       |
| state_code               | The code of the state the startup was founded in.            | Nominal   | Different state codes. Like CA, AZ              |
| latitude                 | The latitude of the startup headquarters.                    | Numerical | 90 to -90                                       |
| longitude                | The longitude of the startup headquarters.                   | Numerical | 0 to 180                                        |
| zip_code                 | The zip code of the city the startup was founded in.         | Nominal   | Different random city zipcodes                  |
| id                       | N/A                                                          | Nominal   | Data in unrecognizable format c:number          |
| city                     | The name of the city the startup was founded in.             | Nominal   | Different cities. Like Palo Alto, Mountain View |
| Unnamed: 6               | The address of the headquarters.                             | Nominal   | Different addresses. Like San Diego CA 92121    |
| name                     | The name of the startup.                                     | Nominal   | Different names. Like Qsecure, drop.io          |
| labels                   | N/A                                                          | Binary    | 0 or 1                                          |
| founded_at               | Startup founding date.                                       | Nominal | 01 1984 to 09 2010                              |
| closed_at                | Startup closing date.                                        | Nominal | 01 2001 to 08 2013                              |
| first_funding_at         | Startup first funding date.                                  | Nominal | 01 2000 to 09 2009                              |
| last_funding_at          | Startup last funding date.                                   | Nominal | 01 2001 to 09 2011                              |
| age_first_funding_year   | The average age of startup when received first funding.      | Numerical | 0 to 21                                         |
| age_last_funding_year    | The average age of startup when received last funding.       | Numerical | 0 to 21                                         |
| age_first_milestone_year | The average age of startup when acheived first milestone.    | Numerical | 0 to 24                                         |
| age_last_milestone_year  | The average age of startup when acheived last milestone.     | Numerical | 0 to 24                                         |
| relationships            | N/A                                                          | Numerical | 0 to 63                                         |
| funding_rounds           | The number of funding rounds the startup went through.       | Numerical | 1 to 10                                         |
| funding_total_usd        | The total number of money in USD raised by the startup.      | Numerical | 11000 to 5700000000                             |
| milestones               | The total number of milestones achieved by the startup.      | Numerical | 0 to 8                                          |
| state_code.1             | The code of the state the startup was founded in.            | Nominal   | Different state codes. Like CA, AZ              |
| is_CA                    | If the startup was founded in California.                    | Binary    | 0 or 1                                          |
| is_NY                    | If the startup was founded in New York.                      | Binary    | 0 or 1                                          |
| is_MA                    | If the startup was founded in Massachusetts.                 | Binary    | 0 or 1                                          |
| is_TX                    | If the startup was founded in Texas.                         | Binary    | 0 or 1                                          |
| is_otherstate            | If the startup was founded in a state other than the listed. | Binary    | 0 or 1                                          |
| category_code            | The sector of the startup.                                   | Nominal   | Different categories. Like biotech, mobile   |
| is_software              | If the startup sector is software.                           | Binary    | 0 or 1                                          |
| is_web                   | If the startup sector is web.                                | Binary    | 0 or 1                                          |
| is_mobile                | If the startup sector is mobile.                             | Binary    | 0 or 1                                          |
| is_enterprise            | If the startup sector is enterprise.                         | Binary    | 0 or 1                                          |
| is_advertising           | If the startup sector is advertising.                        | Binary    | 0 or 1                                          |
| is_gamesvideo            | If the startup sector is video games.                        | Binary    | 0 or 1                                          |
| is_ecommerce             | If the startup sector is ecommerce.                          | Binary    | 0 or 1                                          |
| is_biotech               | If the startup sector is biotech.                            | Binary    | 0 or 1                                          |
| is_consulting            | If the startup sector is consulting.                         | Binary    | 0 or 1                                          |
| is_othercategory         | If the startup sector is any other category that the listed. | Binary    | 0 or 1                                          |
| object_id                | N/A                                                          | Nominal   | Data in unrecognizable format c:number          |
| has_VC                   | If the startup has a venture capitalist\* investor.          | Binary    | 0 or 1                                          |
| has_angel                | If the startup has an angel\*\* investor.                    | Binary    | 0 or 1                                          |
| has_roundA               | If the startup went through a series A funding round.        | Binary    | 0 or 1                                          |
| has_roundB               | If the startup went through a series B funding round.        | Binary    | 0 or 1                                          |
| has_roundC               | If the startup went through a series C funding round.        | Binary    | 0 or 1                                          |
| has_roundD               | If the startup went through a series D funding round.        | Binary    | 0 or 1                                          |
| avg_participants         | The average number of participants in the startup.           | Binary    | 0 or 1                                          |
| is_top500                | If the startup is a top 500 company.                         | Binary    | 0 or 1                                          |
| status                   | The acquisition status of the startup.                       | Binary    | "acquired" or "closed"                          |

***VC** stands for Venture Capitalist. Which is a type of investor that invests the money of a venture capital firm into small startup companies.

\*\***Angel** stands for Angel Investor Which is a type of investor that invests their personal money  into small startup companies in exchange for a percentage in the company.


#### Installing necessary packages:
```{r}
install.packages("readxl")
install.packages("lubridate")
install.packages("scatterplot3d") 
install.packages("dplyr")
install.packages("ggplot2")
install.packages("colorspace")
```

```{r}
library(readxl)
dataset <- read_excel("Original_StartupData.xlsx")
```

#### Sample of raw dataset and summary:

```{r}
View(dataset)
summary(dataset)
```

## 2-Data Preprocessing 


### 2.1-Data Cleaning:

To clean the data of the dataset, we are going to detect and remove outliers, fill in missing values, and replace negative values.

#### Missing Values
```{r}
is.na(dataset) 
sum(is.na(dataset))
```
As demonstrated, **only four attributes contain missing values: Unnamed: 6, closed_at, age_first_milestone_year, and age_last_milestone_year**. From the four attributes, there are **1386 missing values** we are going to deal with.

For **attribute Unnamed: 6**, we will not fill it with any values as it will be deleted later in the data reduction step. 

As for **attribute closed_at**, we will fill all missing values with the global constant N/A because information about the operation of the company (whether is is still open or closed) remains unknown. 

```{r}
dataset$closed_at[is.na(dataset$closed_at)] <- "N/A"
```

Finally, for **attributes age_first_milestone_year and age_last_milestone_year** we will replace missing values with the attribute's mean. 

```{r}
dataset$age_first_milestone_year = ifelse (is.na(dataset$age_first_milestone_year), ave(dataset$age_first_milestone_year, FUN=function(x)mean(x,na.rm=TRUE)), dataset$age_first_milestone_year)

dataset$age_last_milestone_year = ifelse (is.na(dataset$age_last_milestone_year), ave(dataset$age_last_milestone_year, FUN=function(x)mean(x,na.rm=TRUE)), dataset$age_last_milestone_year)
```

#### Negative values

Negative values in attributes related to age do not make sense. So, we are going to change all negative values to positive. 

```{r}
# Remove the negative sign from age_first_funding_year
dataset$age_first_funding_year <- abs(dataset$age_first_funding_year)

# Remove the negative sign from age_last_funding_year
dataset$age_last_funding_year <- abs(dataset$age_last_funding_year)

# Remove the negative sign from age_first_milestone_year
dataset$age_first_milestone_year <- abs(dataset$age_first_milestone_year)

# Remove the negative sign from age_last_milestone_year
dataset$age_last_milestone_year <- abs(dataset$age_last_milestone_year)
```



#### Outliers 

We will detect outliers in all numerical attributes and remove them.

```{r}
install.packages("outliers")
library(outliers)
```

##### Sample of scatter plot before removing outliers from attribute age_first_milestone_year:
```{r}
plot(dataset$age_first_funding_year, dataset$age_first_milestone_year, 
     main="Age First Funding Year vs. Age First Milestone Year", 
     xlab = "Age First Funding Year", 
     ylab = "Age First Milestone Year")
```

```{r}
## age_first_funding_year

# Calculate the quartiles
Q1 <- quantile(dataset$age_first_funding_year, 0.25)
Q3 <- quantile(dataset$age_first_funding_year, 0.75)

# Calculate the IQR
IQR <- Q3 - Q1

# Define the lower and upper bounds for outliers
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR

# Remove outliers from the dataset using dplyr
library(dplyr)

dataset_clean1 <- dataset %>%
  filter(age_first_funding_year >= lower_bound, age_first_funding_year <= upper_bound)

# Print the dimensions of the cleaned dataset
cat("funding_total_usd","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean1), "\n","\n")
dataset <- dataset_clean1

#################################
## age_last_funding_year

Q1 <- quantile(dataset$age_last_funding_year, 0.25)
Q3 <- quantile(dataset$age_last_funding_year, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean2 <- dataset %>%
  filter(age_last_funding_year >= lower_bound, age_last_funding_year <= upper_bound)

cat("age_last_funding_year","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean2), "\n","\n")
dataset <- dataset_clean2

#################################
## age_first_milestone_year

Q1 <- quantile(dataset$age_first_milestone_year, 0.25)
Q3 <- quantile(dataset$age_first_milestone_year, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean3 <- dataset %>%
  filter(age_first_milestone_year >= lower_bound, age_first_milestone_year <= upper_bound)

cat("age_first_milestone_year","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean3), "\n","\n")
dataset <- dataset_clean3

#################################
## age_last_milestone_year

Q1 <- quantile(dataset$age_last_milestone_year, 0.25)
Q3 <- quantile(dataset$age_last_milestone_year, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean4 <- dataset %>%
  filter(age_last_milestone_year >= lower_bound, age_last_milestone_year <= upper_bound)

cat("age_last_milestone_year","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean4), "\n","\n")
dataset <- dataset_clean4

#################################
## relationships

Q1 <- quantile(dataset$relationships, 0.25)
Q3 <- quantile(dataset$relationships, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean5 <- dataset %>%
  filter(relationships >= lower_bound, relationships <= upper_bound)

cat("relationships","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean5), "\n","\n")
dataset <- dataset_clean5

#################################
## funding_rounds

Q1 <- quantile(dataset$funding_rounds, 0.25)
Q3 <- quantile(dataset$funding_rounds, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean6 <- dataset %>%
  filter(funding_rounds >= lower_bound, funding_rounds <= upper_bound)

cat("funding_rounds","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean6), "\n","\n")
dataset <- dataset_clean6

#################################
## funding_total_usd

Q1 <- quantile(dataset$funding_total_usd, 0.25)
Q3 <- quantile(dataset$funding_total_usd, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean7 <- dataset %>%
  filter(funding_total_usd >= lower_bound, funding_total_usd <= upper_bound)

cat("funding_total_usd","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean7), "\n","\n")
dataset <- dataset_clean7

#################################
## milestones

Q1 <- quantile(dataset$milestones, 0.25)
Q3 <- quantile(dataset$milestones, 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
library(dplyr)
dataset_clean8 <- dataset %>%
  filter(milestones >= lower_bound, milestones <= upper_bound)

cat("milestones","\n")
cat("Original dataset dimensions: ", dim(dataset), "\n")
cat("Cleaned dataset dimensions: ", dim(dataset_clean8), "\n","\n")

dataset <- dataset_clean8
```


##### Sample of scatter plot after removing outliers from attribute age_first_milestone_year:
```{r}
plot(dataset$age_first_funding_year, dataset$age_first_milestone_year, 
     main="Age First Funding Year vs. Age First Milestone Year", 
     xlab = "Age First Funding Year",
     ylab = "Age First Milestone Year")
```
Attributes **latitude** and **longitude** will be removed in the data reduction step. Therefore, it will be unnecessary to detect their outliers. 


### 2.2-Data Integration:

```{r}
contingency_table <- table(dataset$zip_code, dataset$city)
chi_square_result <- chisq.test(contingency_table)
print(chi_square_result)
```
With the results above, we can interpret that zip_code and city have a **significance correlation** between them. In other words, **they are not independent (dependent) and we can eliminate one of them**. We chose to delete zip_code and keep city. Because city constitutes a part of attribute Unnammed: 6, and if we want to delete column Unnamed: 6 we must keep city. 


### 2.3-Data Reduction:

#### Dimensionality Reduction: Attribute Subset Selection

From the data integration step, we can infer that the **attributes to remove are:**

| Attribute(s)                  | Keep               | Remove     | Why                             |
| ----------------------------- | ------------------ | ---------- | ------------------------------- |
| state_code, state_code.1      | state_code.1       | state_code | Duplicate attribute             |
| latitude                      | N/A                | latitude   | Irrelevant                      |
| longitude                     | N/A                | longitude  | Irrelevant                      |
| zip_code, city                | city               | zip_code   | Dependent attributes (chi-square test) |
| id                            | N/A                | id         | Irrelevant and unclear          |
| Unnamed:6, city, state_code.1 | city, state_code.1 | Unnamed:6  | Redundant attribute             |
| object_id                     | N/A                | object_id  | Irrelevant and unclear          |

```{r}
# Create a list of column names to remove
columns_to_remove <- c("state_code", "latitude", "longitude", "zip_code", "id", "Unnamed: 6", "object_id")

# Remove the specified columns from the dataset
dataset <- dataset[, !names(dataset) %in% columns_to_remove]

# View the updated dataset
head(dataset)
```
```{r}
ncol(dataset)
nrow(dataset)
```


### 2.4-Data Transformation:

#### Normalization 

Normalize attributes: funding_total_usd, age_first_funding, age_last_funding, age_first_milestone, age_last_milestone, avg_participants into discrete numbers (remove all numbers after the decimal). 

```{r}
normalize <- function(x) {return(as.integer(x))}

dataset$funding_total_usd <- normalize(dataset$funding_total_usd)
dataset$age_first_funding_year <- normalize(dataset$age_first_funding_year)
dataset$age_last_funding_year <- normalize(dataset$age_last_funding_year)
dataset$age_first_milestone_year <- normalize(dataset$age_first_milestone_year)
dataset$age_last_milestone_year <- normalize(dataset$age_last_milestone_year)
dataset$avg_participants <- normalize(dataset$avg_participants)
```

```{r}
normalize <- function(x) {return ((x - min(x)) / (max(x) - min(x)))}
dataset$funding_total_usd<-normalize(dataset$funding_total_usd)
head(dataset)
```

#### Aggregation 

Aggregate attributes: founded_at, closed_at, first_funding_at, last_funding_at into ( mm-yyyy ) format. 

```{r}
library(lubridate)

dataset$founded_at <- as.Date(dataset$founded_at, format = "%m/%d/%Y")
dataset$closed_at <- as.Date(dataset$closed_at, format = "%m/%d/%Y")
dataset$first_funding_at <- as.Date(dataset$first_funding_at, format = "%m/%d/%Y")
dataset$last_funding_at <- as.Date(dataset$last_funding_at, format = "%m/%d/%Y")

dataset$founded_at <- format(dataset$founded_at, "%m-%Y")
dataset$closed_at <- format(dataset$closed_at, "%m-%Y")
dataset$first_funding_at <- format(dataset$first_funding_at, "%m-%Y")
dataset$last_funding_at <- format(dataset$last_funding_at, "%m-%Y")
```
```{r}
# View the updated dataset
tail(dataset)
```

## 3-Data Summary & Visualization

### 3.1-Data Summary after preprocessing:


```{r}
# number of rows
nrow(dataset)
```
There are 727 rows in the dataset after preprocessing. 


```{r}
#number of columns
ncol(dataset)
```
There are 42 columns in the dataset after preprocessing. 


```{r}
# dimensionality
dim(dataset)
```
There are 727 rows and 42 columns in the dataset after preprocessing. 

#### Column Names of Clean (Preprocessed) Dataset
```{r}
names(dataset)
```

#### Column Names of Original Dataset for Comparison

```{r}
# Load the readxl package if not already loaded
library(readxl)

# Read the Excel file into the 'OriginalDataset' variable
OriginalDataset <- read_excel("Original_StartupData.xlsx")

# Get the column names of the imported dataset
column_names <- names(OriginalDataset)

# Display the column names
print(column_names)
```
```{r}
# structure of dataset
str(dataset)
```

```{r}
# attributes of dataset
attributes(dataset)
```
#### Summary of Data

```{r}
summary(dataset)
```
```{r}
library(Hmisc)
describe(dataset)
```
### 3.2-Plotting 


#### A) Distribution of Age First Funding 

```{r}
var(dataset$age_first_funding_year)
```
```{r}
hist(dataset$age_first_funding_year, 
     main = "Age First Funding Year",
     xlab = "Age (Years)",
     ylab = "Frequency",
     col = "blue",
     border = "black")
```
The majority of startups secure their first funding within the company's first year. However, the older the startup is, the less funding its expected to receive. 


#### B) Relationship between Total Funding and Average Number of Participants

```{r}
with(dataset, plot(avg_participants, funding_total_usd, col = avg_participants, pch = as.numeric(avg_participants), main = "Total Funding vs Average Number of Participants",
     xlab = "Average Number of Participants",
     ylab = "Total Funding"))
```
The higher the average number of participants in a startup, the lesser the amount of funding received. This may suggest that startups with average number of participants less than 5 receive more funding than those higher than 5. 


#### C) Distribution of Startup State of Origin

```{r}
library(ggplot2)

# Create a data frame with the counts of each binary attribute
binary_data <- data.frame(
  Attribute = c("is_CA", "is_NY", "is_MA", "is_TX", "is_otherstate"),
  Count = c(
    sum(dataset$is_CA),
    sum(dataset$is_NY),
    sum(dataset$is_MA),
    sum(dataset$is_TX),
    sum(dataset$is_otherstate)
  )
)

# Calculate percentages
binary_data$Percentage <- (binary_data$Count / sum(binary_data$Count)) * 100

# Create a pie chart
pie_chart <- ggplot(binary_data, aes(x = "", y = Percentage, fill = Attribute)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +  # Convert to polar coordinates for a pie chart
  labs(title = "Startup State of Origin") +
  scale_fill_manual(values = c("is_CA" = "blue", "is_NY" = "green", "is_MA" = "red", "is_TX" = "orange", "is_otherstate" = "purple")) +
  theme_minimal() +  # Use a minimal theme
  geom_text(aes(label = paste0(round(Percentage, 1), "%")), position = position_stack(vjust = 0.5))

# Display the pie chart
print(pie_chart)
```
As depicted, the 51.4% of all startups originate from California. Representing the majority. 


#### D) Distribution of Startup Sectors

```{r}
library(ggplot2)
library(scales)

# Create a data frame for your binary attributes
binary_data <- data.frame(
  Attribute = c("is_software", "is_web", "is_mobile", "is_enterprise", "is_advertising", "is_gamesvideo", "is_ecommerce", "is_biotech", "is_consulting", "is_othercategory"),
  Value = c(sum(dataset$is_software), sum(dataset$is_web), sum(dataset$is_mobile), sum(dataset$is_enterprise), sum(dataset$is_advertising), sum(dataset$is_gamesvideo), sum(dataset$is_ecommerce), sum(dataset$is_biotech), sum(dataset$is_consulting), sum(dataset$is_othercategory))
)

# Calculate percentages
binary_data$Percentage <- (binary_data$Value / sum(binary_data$Value)) * 100

# Create the pie chart
pie_chart <- ggplot(binary_data, aes(x = "", y = Percentage, fill = Attribute)) +
  geom_bar(stat = "identity") +
  coord_polar(theta = "y") +
  labs(title = "Startup Category") +
  scale_y_continuous(labels = percent_format(scale = 1))

# Display the pie chart
print(pie_chart)
```
From the histogram, we can deduct that between years 1984 and 2010 the majority of startups focused on sectors other than advertising, biotech, consulting, ecommerce, enterprise, video games, and mobile. Followed by software and then web. 


#### E) Relationship between Different Funding Rounds and 'Acquired' Status

```{r}
var(dataset$has_VC)
var(dataset$has_angel)
var(dataset$has_roundA)
var(dataset$has_roundB)
var(dataset$has_roundC)
var(dataset$has_roundD)
```
```{r}
library(ggplot2)

# Filter rows where status is "acquired"
acquired_data <- subset(dataset, status == "acquired")

# Create a long-format dataset for use with ggplot2
library(tidyr)
acquired_data_long <- gather(acquired_data, key = "Attribute", value = "BinaryValue", has_VC, has_angel, has_roundA, has_roundB, has_roundC, has_roundD)

# Create histograms with facet_wrap
ggplot(acquired_data_long, aes(x = BinaryValue)) +
  geom_histogram(binwidth = 1, fill = "red", color = "black") +
  facet_wrap(~ Attribute, scales = "free_x") +
  labs(title = "Distribution of Different Funding Rounds for 'Acquired' Status",
       x = "Value",
       y = "Frequency")
```
As illustrated, the majority of "acquired" startups went through a series A funding rounds, and almost all "acquired" startups had a series B funding. 

#### F) Relationship between Different Funding Rounds and 'Closed' Status

```{r}
library(ggplot2)

# Filter rows where status is "closed"
closed_data <- subset(dataset, status == "closed")

# Create a long-format dataset for use with ggplot2
library(tidyr)
closed_data_long <- gather(closed_data, key = "Attribute", value = "BinaryValue", has_VC, has_angel, has_roundA, has_roundB, has_roundC, has_roundD)

# Create histograms with facet_wrap
ggplot(closed_data_long, aes(x = BinaryValue)) +
  geom_histogram(binwidth = 1, fill = "red", color = "black") +
  facet_wrap(~ Attribute, scales = "free_x") +
  labs(title = "Distribution of Binary Attributes for 'Closed' Status",
       x = "Value",
       y = "Frequency")
```
As illustrated, the majority of "closed" startups did not have an angel or VC investors, series A, series B, series C or series D funding rounds. 

The majority of "acquired" startups had a series A funding round, while the majority of "closed" startups did not. Series A and Series B funding could be a potential indicator of startup success. 

Angel investors invested almost equally in both "acquired" and "closed" startups. 

VCs tend to invest more in startups that become "acquired" in the future. 


#### G) Relationship between the Number of Funding Rounds and Total Funding Raised

```{r}
range(dataset$funding_total_usd)
```
The least amount of funding invested in a startup was 11000 USD. The most (max) amount of funding invested in a startup after normalization and removing outliers was 47218498 USD. 

```{r}
quantile(dataset$funding_total_usd)
```

```{r}
range(dataset$funding_rounds)
```

```{r}
boxplot(dataset$funding_total_usd ~ dataset$funding_rounds,
        xlab = "Number of Funding Rounds",
        ylab = "Funding Total (USD)",
        main = "Funding Rounds vs Funding Total")
```
As depicted in the boxplot above, the more funding rounds, the more money raised. 


#### H) Relationship between Total Funding and Startup Category

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)

# Summary table: Sum of funding for each category
category_funding_summary <- dataset %>%
  group_by(is_software, is_web, is_mobile, is_enterprise, 
           is_advertising, is_gamesvideo, is_ecommerce, is_biotech, is_consulting, is_othercategory) %>%
  summarise(total_funding = sum(funding_total_usd))

# Reshape the data for plotting
category_funding_summary <- category_funding_summary %>%
  pivot_longer(
    cols = -total_funding,
    names_to = "Category",
    values_to = "BinaryValue"
  )

# Create a bar plot
ggplot(category_funding_summary, aes(x = Category, y = total_funding, fill = BinaryValue)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Funding vs Startup Category", x = "Category", y = "Total Funding") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
As demonstrated in the grouped bar chart above, the highest amount of funding went to tech-related sectors. Exemplified by the top three categories: is_mobile, is_software, is_web. 


#### I) Relationship between Top 500 Companies and Status

```{r}
library(ggplot2)

# Create a summary table to count the combinations of is_top500 and status
summary_table <- table(dataset$is_top500, dataset$status)

# Convert the summary table to a data frame
summary_df <- as.data.frame(summary_table)

# Rename the columns for clarity
colnames(summary_df) <- c("is_top500", "status", "count")

# Create a barplot
ggplot(summary_df, aes(x = is_top500, y = count, fill = status)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Top 500 Company vs. Status",
       x = "Top 500", y = "Count") +
  scale_fill_manual(values = c("acquired" = "blue", "closed" = "red"))
```
The vast majority of top 500 companies are acquired companies.

#### J) Heatmap
```{r}
dist.matrix <-- as.matrix(dist(dataset[1:10]))
heatmap(dist.matrix)
```